<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>Add Graphics to a SceneView - 4.11</title>
    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.11/esri/css/main.css"
    />
    <script src="https://js.arcgis.com/4.11/"></script>
    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
      #outputMessages {
        position: absolute;
        z-index: 70;
        top: 0px;
        right: 0;
        bottom: 0;
        box-sizing: border-box;
        padding: 20px;
        height: 100%;
        width: 350px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 14px;
        line-height: 30px;
        overflow: auto;
      }
      #outputMessages span {
        color: #f7be81;
        font-weight: bold;
      }
    </style>
    <script>
      require([
        "esri/Map",
        "esri/views/SceneView",
        "esri/Graphic",
        "esri/geometry/Polyline",
        "esri/geometry/Point",
        "esri/layers/ElevationLayer",
        "esri/core/promiseUtils",
        "esri/core/watchUtils",
        "esri/layers/GraphicsLayer",
      ], function (
        Map,
        SceneView,
        Graphic,
        Polyline,
        Point,
        ElevationLayer,
        promiseUtils,
        watchUtils,
        GraphicsLayer
      ) {
        // Create elevation layers
        var beforeLandslideUrl =
          "//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer/";
        var beforeLandslideLayer = new ElevationLayer({
          url: beforeLandslideUrl,
        });
        // Create Map and View
        var map = new Map({
          basemap: "satellite",
          ground: {
            layers: [beforeLandslideLayer],
          },
        });
        var view = new SceneView({
          container: "viewDiv",
          map: map,
          camera: {
            // initial view:
            heading: 332.8,
            tilt: 65.5,
            position: {
              x: -13563643,
              y: 6153016,
              z: 577,
              spatialReference: {
                wkid: 3857,
              },
            },
            heading: 0.34445102566290225,
            tilt: 82.95536300536367,
          },
        });
        var outputMessages = document.getElementById("outputMessages");
        var cameraX, cameraY, point, markerSymbol, graZ;
        var graphicsLayer = new GraphicsLayer();
        map.add(graphicsLayer);
        markerSymbol = {
          type: "simple-marker",
          // autocasts as new SimpleMarkerSymbol()
          color: [226, 119, 40],
          size: 100,
          outline: {
            // autocasts as new SimpleLineSymbol()
            color: [255, 255, 255],
            width: 0.2,
          },
        };
        watchUtils.whenTrue(view, "stationary", function () {
          graphicsLayer.removeAll();
          cameraX = view.camera.position.longitude;
          cameraY = view.camera.position.latitude + 0.2;
          point = {
            type: "point",
            // autocasts as new Point()
            x: cameraX,
            y: cameraY,
          };
          beforeLandslideLayer
            .queryElevation(new Point(point), { returnSampleInfo: true })
            .then(function (result) {
              graZ = result.geometry.z;
              var info =
                "<span> the view center changed. </span>" +
                "<br>  x: " +
                cameraX +
                "<br>  y: " +
                cameraY +
                "<br>  z: " +
                graZ +
                "<br> Camera z: " +
                (view.camera.position.z - graZ);
              displayMessage(info);
            })
            // Failed to sample (e.g. service unavailable)
            .catch(function (error) {
              console.error("Failed to query elevation:", error);
            });
          graphicsLayer.add(
            new Graphic({
              geometry: point,
              symbol: markerSymbol,
            })
          );
        });
        function displayMessage(info) {
          outputMessages.innerHTML = info;
          outputMessages.scrollTop = outputMessages.scrollHeight;
        }
      });
    </script>
  </head>
  <body>
    <div id="viewDiv">
      <div id="outputMessages"></div>
      <div id="titleDiv"></div>
    </div>
  </body>
</html>
‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍